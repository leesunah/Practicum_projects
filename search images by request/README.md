# Поиск изображений по текстовому запросу

Демонстрационная версия системы поиска изображений по текстовому запросу. Модель получает векторные представления изображения и текста, а на выходе выдает число от 0 до 1, показывающее степень соответствия текста и изображения.

## Описание данных

### Обучающие данные
- **train_dataset**: Содержит имена файлов изображений, идентификаторы описаний и тексты описаний
  - `image`: Имя файла изображения (1000 уникальных изображений)
  - `query_id`: Идентификатор описания в формате `<имя_файла>#<индекс>` (977 уникальных)
  - `query_text`: Текст описания (977 уникальных текстов)
- До 5 описаний на одно изображение
- Нет пропущенных значений и дубликатов

### Тестовые данные
- **test_queries**: 500 тестовых запросов
  - `query_id`: Уникальный идентификатор
  - `query_text`: Текст запроса/описания
  - `image`: Целевое изображение
- **test_images.csv**: 100 уникальных тестовых изображений

### Разметки
- **crowd_annotations**: Краудсорсинговые оценки соответствия изображений и текстов
  - 47,830 записей с долями подтверждения и количеством голосов
- **expert_annotations**: Экспертные оценки (3 эксперта на пару)
  - 5,822 записей с оценками от 1 до 4 (1: нет соответствия, 4: полное соответствие)

## Методология

### 1. Анализ и предобработка данных
- Загрузка и исследование всех наборов данных
- Агрегация экспертных оценок с использованием мажоритарного голосования или усреднения
- Нормализация оценок к шкале [0, 1]
- Фильтрация контента, связанного с детьми, для соблюдения законодательства

### 2. Извлечение признаков
- **Векторизация изображений**: Использована модель ResNet50 для извлечения 2048-мерных векторов признаков
- **Векторизация текстов**: Использована модель BERT для извлечения 768-мерных текстовых эмбеддингов
- **Объединение признаков**: Конкатенация векторов изображений и текстов (итого 2816 измерений)

### 3. Обучение моделей
Обучены несколько моделей с использованием GroupShuffleSplit для предотвращения утечки данных:
- Линейная регрессия
- Dummy-регрессор (базовая линия)
- LightGBM регрессор
- Глубокая нейронная сеть

### 4. Оценка моделей
- Основная метрика: RMSE (среднеквадратичная ошибка)
- Лучшая модель: Глубокая нейронная сеть (RMSE: 0.2345)

### Соответствие законодательству
Система автоматически фильтрует контент, связанный с детьми, используя сопоставление по ключевым словам:
- `baby`, `child`, `girl`, `boy`, `kid`, `teenager` и т.д.
- Возвращает сообщение-дисклеймер для запрещенного контента

## Основные  выводы:

- Текущая модель показывает низкую производительность на тестовых данных
- Пары изображение-текст не плохо визуально соответствуют

## Основные проблемы:

- Низкое качество исходных разметок
- Ограниченное количество обучающих данных
- Слабая эффективность на тестовых данных
