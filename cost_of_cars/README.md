# Определение стоимости автомобилей

## Описание проекта

Сервис по продаже автомобилей с пробегом разрабатывает приложение для быстрой оценки рыночной стоимости автомобилей. В данном проекте построена модель машинного обучения, которая предсказывает стоимость автомобиля на основе его характеристик.

**Ключевые требования заказчика:**
- Качество предсказания
- Скорость предсказания  
- Время обучения модели

## Структура проекта

1. **Обзор данных** - первичный анализ и исследование данных
2. **Подготовка данных** - очистка и предобработка данных
3. **Корреляционный анализ** - исследование взаимосвязей между признаками
4. **Обучение моделей** - построение и настройка различных моделей
5. **Анализ моделей** - сравнение производительности моделей
6. **Выбор лучшей модели** - финальная оценка на тестовой выборке

## Данные

Исходный датасет содержит 354,369 объявлений о продаже автомобилей с 16 признаками:

### Признаки:
- `vehicle_type` - тип кузова
- `registration_year` - год регистрации
- `gearbox` - тип коробки передач
- `power` - мощность (л.с.)
- `model` - модель автомобиля
- `kilometer` - пробег (км)
- `fuel_type` - тип топлива
- `brand` - марка автомобиля
- `repaired` - наличие ремонта

### Целевой признак:
- `price` - цена автомобиля в евро

## Методы и технологии

- **Анализ данных**: pandas, numpy, matplotlib, seaborn
- **Корреляционный анализ**: phik
- **Машинное обучение**: scikit-learn, LightGBM
- **Предобработка**: OneHotEncoder, StandardScaler
- **Валидация**: train_test_split, GridSearchCV
- **Метрика**: RMSE (Root Mean Squared Error)

## Модели

Были обучены и протестированы 4 модели:
1. **LinearRegression** - линейная регрессия
2. **RandomForestRegressor** - случайный лес
3. **DecisionTreeRegressor** - дерево решений
4. **LGBMRegressor** - градиентный бустинг

## Результаты

### Сравнение моделей:

| Модель | RMSE | Время обучения | Время предсказания |
|--------|------|----------------|-------------------|
| LinearRegression | 2736.35 | 0.9020 сек | 0.3106 сек |
| DecisionTree | 2905.69 | 3.8976 сек | 0.0140 сек |
| RandomForest | 2758.34 | 16.3668 сек | 0.3205 сек |
| LightGBM | 2788.43 | 4.6045 сек | 0.0618 сек |

### Финальная оценка на тестовой выборке:
- **LinearRegression**: RMSE = 2746.77, время предсказания = 0.1195 сек

## Ключевые выводы

1. **Наиболее важные факторы цены**:
   - Год регистрации (корреляция 0.66)
   - Модель автомобиля (0.58)
   - Мощность двигателя (0.34)
   - Пробег (0.33)

2. **Лучшая модель**: LinearRegression показала оптимальное соотношение качества предсказания и скорости работы, полностью удовлетворяя требованиям заказчика.

3. **Качество модели**: RMSE около 2746 евро указывает на хорошую точность предсказаний для автомобильного рынка.
