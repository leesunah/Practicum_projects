# Прогнозные модели для отбора бурёнок в поголовье

## Описание проекта

Владелец фермы хочет купить бурёнок, чтобы расширить поголовье стада коров. Для этого он заключил выгодный контракт с ассоциацией пастбищ. Условия позволяют фермеру очень тщательно отобрать коров. Он определяет качество молока по строгой методике, и при этом ему нужно выполнять свой план развития молочного хозяйства.

**Цель исследования:** Разработать модель машинного обучения, которая поможет владельцу фермы управлять рисками и принимать объективное решение о покупке.

## Задачи исследования

Создать две прогнозные модели для отбора бурёнок в поголовье:
- Первая будет прогнозировать возможный удой коровы (целевой признак `Удой`)
- Вторая — рассчитывать вероятность получить вкусное молоко от коровы (целевой признак `Вкус молока`)

С помощью модели нужно отобрать коров по двум критериям:
- средний удой за год — не менее 6000 килограммов
- молоко должно быть вкусным

## Данные

Проект использует три файла данных:

1. **Файл `###.csv`** - данные о стаде фермера на текущий момент:
   - `id` — уникальный идентификатор коровы
   - `Удой, кг` — масса молока, которую корова даёт в год
   - `ЭКЕ` — показатель питательности корма
   - `Сырой протеин, г` — содержание сырого протеина в корме
   - `СПО` — сахаро-протеиновое соотношение
   - `Порода` — порода коровы
   - `Тип пастбища` — ландшафт лугов
   - `порода папы_быка` — порода папы коровы
   - `Жирность,%` — содержание жиров в молоке
   - `Белок,%` — содержание белков в молоке
   - `Вкус молока` — оценка вкуса (бинарный признак)
   - `Возраст` — возраст коровы (бинарный признак)

2. **Файл `###.csv`** - имена пап коров в стаде:
   - `id` — уникальный идентификатор коровы
   - `Имя Папы` — имя папы коровы

3. **Файл `###.csv`** - данные о коровах «ЭкоФермы» для покупки:
   - `Порода` — порода коровы
   - `Тип пастбища` — ландшафт лугов
   - `порода папы_быка` — порода папы коровы
   - `Имя_папы` — имя папы коровы
   - `Текущая_жирность,%` — содержание жиров в молоке
   - `Текущий_уровень_белок,%` — содержание белков в молоке
   - `Возраст` — возраст коровы

## Методология

### Предобработка данных
- Удаление дубликатов и обработка выбросов
- Приведение названий столбцов к единому формату
- Исправление неявных дубликатов в категориальных признаках
- Объединение данных из разных источников

### Исследовательский анализ
- Анализ распределения количественных и категориальных признаков
- Исследование взаимосвязей между признаками
- Корреляционный анализ с использованием матрицы Спирмана

### Моделирование

#### Модель линейной регрессии (прогноз удоя)
- Построение трех моделей с различными наборами признаков
- Преобразование признаков для учета нелинейных зависимостей
- Добавление новых признаков (ЭКЕ в квадрате, категоризация СПО)
- Оценка качества моделей с использованием R², MSE, RMSE, MAE

#### Модель логистической регрессии (прогноз вкуса молока)
- Кодирование категориальных признаков
- Масштабирование числовых признаков
- Подбор оптимального порога классификации
- Минимизация ошибок первого рода

## Результаты

### Модель прогноза удоя
Лучшая модель показала следующие результаты:
- **R² score**: 0.825
- **MAE**: 146.2 кг
- **RMSE**: 188.8 кг
- **95% доверительный интервал**: (6092, 6221) кг

### Модель прогноза вкуса молока
После подбора оптимального порога:
- **Precision**: 1.0
- **Recall**: 0.34
- Количество ошибок первого рода: 0

### Рекомендации по покупке
После применения обеих модель к данным «ЭкоФермы» была отобрана **1 корова**, удовлетворяющая обоим критериям:
- Удой более 6221 кг
- Молоко классифицировано как "вкусное"

## Заключение

Разработанная система позволяет фермеру объективно оценивать потенциальных коров для покупки, минимизируя риски и обеспечивая выполнение планов развития хозяйства. 
