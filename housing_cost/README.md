# Прогнозирование стоимости жилья в Калифорнии

Проект по машинному обучению для предсказания медианной стоимости домов в Калифорнии на основе данных 1990 года с использованием Apache Spark и PySpark.

## Описание проекта

В этом проекте реализовано построение моделей линейной регрессии для прогнозирования стоимости жилья. Используются различные методы предобработки данных, включая обработку пропусков, кодирование категориальных переменных и масштабирование признаков.

## Структура данных

Датасет содержит следующие признаки:

- `longitude` — широта
- `latitude` — долгота  
- `housing_median_age` — медианный возраст жителей
- `total_rooms` — общее количество комнат
- `total_bedrooms` — общее количество спален
- `population` — количество проживающих людей
- `households` — количество домовладений
- `median_income` — медианный доход жителей
- `median_house_value` — медианная стоимость дома (целевая переменная)
- `ocean_proximity` — близость к океану (категориальный признак)
- 
## Основные этапы проекта

### 1. Подготовка данных
- Инициализация Spark-сессии
- Загрузка и исследование данных
- Обработка пропущенных значений в колонке `total_bedrooms`
- Анализ корреляций между признаками

### 2. Предобработка признаков
- Кодирование категориальной переменной `ocean_proximity` с помощью One-Hot Encoding
- Масштабирование числовых признаков
- Векторизация признаков для моделей машинного обучения

### 3. Построение моделей
Созданы и обучены две модели линейной регрессии:
- **Модель 1**: Использует все доступные признаки (числовые + категориальные)
- **Модель 2**: Использует только числовые признаки

### 4. Оценка качества моделей
Для сравнения моделей используются метрики:
- **RMSE** (Root Mean Square Error) - среднеквадратичная ошибка
- **MAE** (Mean Absolute Error) - средняя абсолютная ошибка  
- **R²** (Coefficient of Determination) - коэффициент детерминации

## Результаты

| Модель | RMSE | MAE | R² |
|--------|------|-----|----|
| Модель 1 (все признаки) | 70,600.60 | 50,771.64 | 0.64 |
| Модель 2 (только числовые) | 71,884.28 | 51,358.96 | 0.63 |

## Выводы

Модель, обученная на всех доступных признаках (включая категориальные), показала лучшие результаты по всем метрикам:
- На 1.8% лучше по RMSE
- На 1.1% лучше по MAE  
- На 1.6% лучше по R²

Это демонстрирует важность включения категориальных признаков в модель для улучшения прогнозной способности.
